<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>

    <title>De-stress Lab: For a Ruff Day</title>

    <!-- jQuery library -->
    <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
    <!-- Bootstrap -->
    <!-- Latest compiled and minified CSS -->
    <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css'>
    <!-- Latest compiled JavaScript -->
    <script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js'></script>

    <!-- <script type="application/javascript" src='../assets/scripts/index.js'></script> -->
    <!-- <link rel='stylesheet' type='text/css' href='../assets/css/index.css'> -->

  </head>
  <body>

    <noscript>
      You need to enable JavaScript to run this app.
    </noscript>

    <nav class='navbar navbar-light bg-light'>
      <div class='nav navbar-nav navbar-right'>
        <ul id='navbar-contents' class='nav navbar-nav'>
          <li id='login'><a href='#' data-toggle='modal' data-target='#login-modal'>Log In</a></li>
          <li id='signup'><a href='#' data-toggle='modal' data-target='#signup-modal'>Sign Up</a></li>
        </ul>
      </div>
    </nav>

    <style>
      .navbar {
        margin: 0px 20px;
      }

      h1 {
        font-family: sans-serif;
        position: relative;
      }

      body {
        margin: 0;
        padding: 0;
        font-family: sans-serif;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      .container {
        display: flex;
        justify-content: center;
      }

      #game-panel-container {
        overflow: visible;
        display: flex;
      }

      #main-screen {
        position: absolute;
        width: 100%;
        height: 100%;
        overflow: auto;
      }

      #game-view {
        position: absolute;
        width: 100%;
        height: 100%;
        padding: 0;
      }

      .modal {
        position: absolute;
        top: 20%;
        left: 10%;
        width: 80%;
        height: 90%;
      }

      .select-panel:hover {
        transition: 0.3s;
        box-shadow: 0 10px 10px 10px #6b217a8a;
      }

      .col-centered {
        float: none;
        margin: auto;
        margin-right: 22.5%;
      }

      #instructions {
        position: absolute;
        color: white;
        bottom: 8em;
        left: 15em;
      }

      #music-cred {
        font-weight: 700;
        position: absolute;
        bottom: 2em;
        left: 1em;
      }

      #new-breed {
        width: 50%;
        height: 35px;
        position: absolute;
        right: 1em;
        bottom: 0em;
        text-align: center;
      }

      .scrollable {
        max-height: 200px;
        overflow-y: auto;
      }

      .modal-body scrollable {
        max-height: 50%;
        overflow-y: auto;
      }

    </style>

    <script type='text/javascript'>
      var presetUser = 'DogLovingHuman';
      var presetPwd = 'ILoveDogs123';
      var presetBreeds = ['beagle', 'retriever'];
      var presetStressors = ['work', 'school', 'deadlines', 'bad music',
          'cliffhangers', 'bills', 'responsibilities'];

      var currentBreeds = null;
      var currentStressors = null;
      var auth = false;
      var navbarContents = $('#navbar-contents');
      /**
       * This will handle login during assignment 3 but for now it will
       * print the username and password to console and allow a user
       * to log in, regardless of correct credentials.
       */
      $('#login-modal #login-button').on('click', function () {
          var username = $('#login-modal #username').val();
          var password = $('#login-modal #login-pwd').val();

          // Log it, in Assignment 3, we will send it to the server instead
          console.log('username: ' + username);
          console.log('password: ' + password);

          // Will be replaced with proper authentication in Assignment 3
          if (username === presetUser && password === presetPwd) {
              loginSetup(username);
          } else {
              alert("Login failed.");
          }
      });

      /**
       * Similar to login, a user can sign up without proper credentials,
       * as long as the two passwords match.
       */
      $('#signup-modal #signup-button').on('click', function () {
          console.log("singing");
          var username = $('#signup-modal signup-username');
          var pwd1 = $('#signup-modal #pwd').val();
          var pwd2 = $('#signup-modal #re-enter').val();

          // Log it, in Assignment 3, we will send it to the server instead
          console.log('username: ' + $('#signup-modal #username').val());
          console.log('password: ' + pwd1);
          console.log('password: ' + pwd2);

          if (pwd1 === pwd2) {
              loginSetup(username);
          } else {
              alert('Sign up unsuccessful.');
          }
      });

      /**
       * Returns login and signup buttons to where they were and removes
       * the sign out button.
       */
      $('#signout-modal #signout-button').on('click', function () {
          var navbarContents = $('#navbar-contents');
          $('#signout').remove();
          $('#accsettings').remove();

          // remove from account settings modal
          var nodes = document.getElementById('breed-pref').childNodes;
          var len = nodes.length;
          for(var i = len - 1; i >= 0; i--) {
              nodes[i].remove();
          }
          nodes = document.getElementById('stress-list').childNodes;
          len = nodes.length;
          for(var i = len - 1; i >= 0; i--) {
              nodes[i].remove();
          }

          navbarContents.append(login);
          navbarContents.append(signup);

          currentBreeds = null;
          currentStressors = null;

          auth = false;
      });

      $('[data-toggle="popover"]').popover();



      if(auth) {
        console.log("ath");
          navbarContents.append(accSettings);
          navbarContents.append(signout);
      } else {
        console.log("no aut")
          navbarContents.append(login);
          navbarContents.append(signup);
      }
    </script>

    <h1> Welcome to the De-Stress Lab!</h1>

    <div id='main-screen'>
      <div id='game-panel-container' class='container'>
        <img id='shooter-game' class='img-rounded select-panel' src='images/grape.png' alt='Grape' height='40%' width='40%' >
        <img id='pop-game' class='img-rounded select-panel' src='images/patrick.jpg' alt='Patrick' height='40%' width='40%' >
      </div>
    </div>

    <script type='text/javascript'>
    var signout = "<li id='signout'><a href='#' data-toggle='modal' data-target='#signout-modal'>Sign Out</a></li>";
    var accSettings = "<li id='accsettings'><a href='#' data-toggle='modal' data-target='#settings-modal'>Account Settings</a></li>";
    var backButton = "<li id='back'><a href='#'>Back</a></li>";
    var login = "<li id='login'><a href='#' data-toggle='modal' data-target='#login-modal'>Log In</a></li>";
    var signup = "<li id='signup'><a href='#' data-toggle='modal' data-target='#signup-modal'>Sign Up</a></li>";
    $('#pop-game').on('click', function () {
        $('#navbar-contents').append(backButton);
        $('#login').remove();
        $('#signup').remove();
        $('#accsettings').remove();
        $('#signout').remove();
        location.href = "/game/pop";
        document.getElementById('jazz-music').play();
    });
    $('#shooter-game').on('click', function () {
        $('#navbar-contents').append(backButton);
        $('#login').remove();
        $('#signup').remove();
        $('#accsettings').remove();
        $('#signout').remove();
        location.href = "/game/shooter";
        document.getElementById('jazz-music').play();
    });
    </script>

    <!--
      Modals, following Bootstrap modal format.
    -->
    <div id='login-modal'class='modal fade'>
      <div class='modal-content'>
          <div class='modal-header'>
            <h2>Log In</h2>
          </div>
          <div class='modal-body'>
              <div class='form-group'>
                <label for='username'>Username</label>
                <input type='username' class='form-control' id='username'>
              </div>
              <div class='form-group'>
                <label for='login-pwd'>Password</label>
                <input type='password' class='form-control' id='login-pwd'>
              </div>
          </div>
          <div class='modal-footer'>
            <button id='login-button' type='button' class='btn btn-default' data-dismiss='modal'>Log In</button>
            <button type='button' class='btn btn-default' data-dismiss='modal'>Close</button>
          </div>
      </div>
    </div>

    <div id='signup-modal'class='modal fade'>
      <div class='modal-content'>
          <div class='modal-header'>
            <h2>Sign Up</h2>
          </div>
          <div class='modal-body'>
              <div class='form-group'>
                <label for='signup-username'>Username</label>
                <input type='username' class='form-control' id='signup-username'>
              </div>
              <div class='form-group'>
                <label for='pwd'>Password</label>
                <input type='password' class='form-control' id='pwd'>
              </div>
              <div class='form-group'>
                <label for='re-enter'>Re-enter Password</label>
                <input type='password' class='form-control' id='re-enter'>
              </div>
          </div>
          <div class='modal-footer'>
            <button id='signup-button' type='button' class='btn btn-default' data-dismiss='modal'>Sign Up</button>
            <button type='button' class='btn btn-default' data-dismiss='modal'>Close</button>
          </div>
      </div>
    </div>

    <div id='signout-modal'class='modal fade'>
      <div class='modal-content'>
          <div class='modal-header'>
            <h2>Sign Out</h2>
          </div>
          <div class='modal-body'>
              <div class='form-group'>
                <p>Would you like to sign out of your account?</p>
              </div>
          </div>
          <div class='modal-footer'>
            <button id='signout-button' type='button' class='btn btn-default' data-dismiss='modal'>Yes</button>
            <button type='button' class='btn btn-default' data-dismiss='modal'>No</button>
          </div>
      </div>
    </div>
  </body>

  <div id='settings-modal'class='modal fade'>
    <div class='modal-content'>
        <div class='modal-header'>
          <button type='button' class='close' data-dismiss='modal'>&times;</button>
          <ul class='nav nav-tabs'>
            <li class='active'><a data-toggle='tab' href='#breed-tab'>Breed Preference</a></li>
            <li><a data-toggle='tab' href='#stress-tab'>Stress List</a></li>
          </ul>
        </div>
        <div class='modal-body'>
          <div class='tab-content'>
            <div id='breed-tab' class='tab-pane fade in active'>
              <h3>My Breeds</h3>
              <div class='list-group scrollable' id='breed-pref'></div>
              <button id='add-stress' type='button' class='btn btn-default' data-toggle='modal' data-target='#addbreed-modal'>Add</button>
            </div>
            <div id='stress-tab' class='tab-pane fade'>
              <h3>My Stressors</h3>
              <div class='list-group scrollable' id='stress-list'></div>
              <button id='add-stress' type='button' class='btn btn-default' data-toggle='modal' data-target='#addstress-modal'>Add</button>
            </div>
          </div>
        </div>
    </div>
  </div>

  <div id='addbreed-modal'class='modal fade'>
    <div class='modal-content'>
        <div class='modal-header'>
          <button type='button' class='close' data-dismiss='modal'>&times;</button>
          <h2>New Breed</h2>
        </div>
        <div class='modal-body'>
          <div class='input-group'>
            <div class='dropdown'>
              <button class='btn btn-primary dropdown-toggle' type='button' data-toggle='dropdown'>Breeds
              <span class='caret'></span></button>
              <ul class='dropdown-menu scrollable' id='dropdown-menu'></ul>
            </div>
            <input type='text' class='form-control' id='new-breed' disabled='disabled'></input>
            <div class='input-group-btn'>
              <button class='btn btn-default' type='submit' id='save-breed'><i class='glyphicon glyphicon-plus-sign'></i></button>
            </div>
          </div>
        </div>
    </div>
  </div>

  <div id='addstress-modal'class='modal fade'>
    <div class='modal-content'>
        <div class='modal-header'>
          <button type='button' class='close' data-dismiss='modal'>&times;</button>
          <h2>New Stressor</h2>
        </div>
        <div class='modal-body'>
          <div class='input-group'>
            <input type='text' class='form-control' id='new-stressor'>
            <div class='input-group-btn'>
              <button class='btn btn-default' type='submit' id='save-stressor'><i class='glyphicon glyphicon-plus-sign'></i></button>
            </div>
          </div>
        </div>
    </div>
  </div>

  </body>
</html>
